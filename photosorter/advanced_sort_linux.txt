echo "Start sorting..."
create_folder_if_not_exists() {
    folder_path="$1"

    if [ ! -d "$folder_path" ]; then
        mkdir "$folder_path"
    fi
}
move_file_to_folder_if_required() {
    file_path="$1"
    folder_path="$2"

    if [ -f "$file_path" ]; then
        file_name=$(basename "$file_path")
        destination_path="$folder_path/$file_name"

        if [ "$file_path" != "$destination_path" ]; then
            mv "$file_path" "$destination_path"
            echo "$destination_path" >> moved_files.txt
        else
            echo "WARNING: File not moved: File $file_path is already in folder: $folder_path"
        fi
    else
        echo "WARNING: File not moved: File $file_path not found"
    fi
}

create_bash_file_with_function() {
    cat <<EOF > undo_sort.sh
#!/bin/bash

remove_files_to_current_directory() {
    echo "Undoing file sort..."
    file_path='moved_files.txt'

    if [ -f "\$file_path" ]; then
        while IFS= read -r file; do
            if [ -f "\$file" ]; then
                file_name=\$(basename "\$file")
                mv "\$file" "\$file_name"
            else
                echo "WARNING: Cannot undo: File does not exist: \$file"
            fi
        done < "\$file_path"
        rm "\$file_path"
        rm "\$0"

        echo "Self destructed undo file and script."
    else
        echo "ERROR: Cannot find undo file \$file_path"
    fi
    echo "Done!"
}

remove_files_to_current_directory
EOF
    chmod +x ./undo_sort.sh
    echo "Undo sort script 'undo_sort.sh' has been created."
}

create_bash_file_with_function

create_folder_if_not_exists "face"
create_folder_if_not_exists "laughing"
create_folder_if_not_exists "landscape"
create_folder_if_not_exists "sea"
create_folder_if_not_exists "machine"

move_file_to_folder_if_required "DSC01043.jpg" "laughing"
move_file_to_folder_if_required "DSC01043.jpg" "laughing"
move_file_to_folder_if_required "DSC0001045.jpg" "laughing"
move_file_to_folder_if_required "DSC01046.jpg" "laughing"
move_file_to_folder_if_required "IMG_0343.jpg" "landscape"
move_file_to_folder_if_required "IMG_8152.jpg" "landscape"
move_file_to_folder_if_required "IMG_8158.jpg" "landscape"
move_file_to_folder_if_required "IMG_0344.jpg" "sea"
move_file_to_folder_if_required "IMG_0346.jpg" "sea"
move_file_to_folder_if_required "IMG_8157.jpg" "sea"
move_file_to_folder_if_required "PXL_20230317_213116563.MP.jpg" "machine"

echo "Sorting done!"
