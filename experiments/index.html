<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Experiments</title>
    <meta name="viewport" content="initial-scale=1.0, width=device-width">
    <link href="https://fonts.googleapis.com/css?family=Merriweather:300&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/stylesheet.css">

    <style>

        .progress-bar {
            width: 10vw;
            height: 2em;
            border: 1px solid #ccc;
            position: relative;
        }

        .progress {
            width: 0;
            height: 100%;
            background-color: #4CAF50;
        }

        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-weight: bold;
        }
    </style>
</head>
<body>

<div class="center-horizontal-parent">
    <h1>Experiment</h1>
    <input id="file-upload" type="file" name="myfile" multiple/>

    <div class="progress-bar" id="zip-progress">
        <div class="progress"></div>
        <div class="progress-text"></div>
    </div>
    <button id="hoi">clicc</button>
</div>

<script>
    async function handleUploadedFiles(files) {
        files = Array.from(files)
        for (let file of files){
            console.log(file.name)
            // let existing = await app.loadFromDb(file.name)
            // console.log(existing)
            let res = await app.saveToDb(file.name,)
            console.log(res)
        }
    }


    function onUploadListener({target}) {
        if (!target.files || !target.files.length) {
            logToUser("No files selected.")
            return;
        }
        handleUploadedFiles(target.files)
    }

    let fileInput = document.getElementById("file-upload");
    fileInput.addEventListener("change", (event) => {
        onUploadListener(event)
    });

    function updateProgressBar(currentIndex, totalIndex, resolveMessage, id) {
        let bar = document.getElementById(id)
        let elements = bar.querySelectorAll("div")
        let progressElement = elements[0]
        let

        var progress = (currentIndex / totalIndex) * 100;
        var progressTextElement = document.getElementById('progress-text');

        progressElement.style.width = progress + '%';
        // progressTextElement.innerText = progress.toFixed(2) + '%';
        progressTextElement.textContent = `Loading ${currentIndex}/${totalIndex}...`

        if (currentIndex === totalIndex) {
            progressTextElement.innerText = resolveMessage;
        }
    }

    // Example usage
    var currentIndex = 3;
    var totalIndex = 10;
    var resolveMessage = 'Process complete';

    updateProgressBar(currentIndex, totalIndex, resolveMessage, id);
    document.getElementById("hoi").addEventListener("click", () => {
        updateProgressBar(7, totalIndex, resolveMessage);
    })

</script>

</body>
</html>
